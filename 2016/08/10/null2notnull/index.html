<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="快乐每一天 夏虫不可以语冰"><title>关于NULL to NOT NULL | 喀秋莎的技术博客</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">关于NULL to NOT NULL</h1><a id="logo" href="/.">喀秋莎的技术博客</a><p class="description">快乐每一天 夏虫不可以语冰</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">关于NULL to NOT NULL</h1><div class="post-meta">Aug 10, 2016<span> | </span><span class="category"><a href="/categories/mysql/">mysql</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/08/10/null2notnull/" href="/2016/08/10/null2notnull/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-NULL-value-means-“no-data-”"><span class="toc-number">1.</span> <span class="toc-text">The NULL value means “no data.”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用"><span class="toc-number">2.</span> <span class="toc-text">使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#官方举例"><span class="toc-number">2.1.</span> <span class="toc-text">官方举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#两个常用的函数"><span class="toc-number">2.2.</span> <span class="toc-text">两个常用的函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注意事项"><span class="toc-number">3.</span> <span class="toc-text">注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据类型相关"><span class="toc-number">3.1.</span> <span class="toc-text">数据类型相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数相关"><span class="toc-number">3.2.</span> <span class="toc-text">函数相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引相关"><span class="toc-number">3.3.</span> <span class="toc-text">索引相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#“坑”相关"><span class="toc-number">3.4.</span> <span class="toc-text">“坑”相关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运维"><span class="toc-number">4.</span> <span class="toc-text">运维</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#无索引的容量对比"><span class="toc-number">4.1.</span> <span class="toc-text">无索引的容量对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有索引的容量对比"><span class="toc-number">4.2.</span> <span class="toc-text">有索引的容量对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#受系统配置影响的"><span class="toc-number">4.3.</span> <span class="toc-text">受系统配置影响的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="post-content"><h2 id="The-NULL-value-means-“no-data-”"><a href="#The-NULL-value-means-“no-data-”" class="headerlink" title="The NULL value means “no data.”"></a>The NULL value means “no data.”</h2><p><strong>The NULL value can be surprising until you get used to it. Conceptually, NULL means “a missing unknown value” and it is treated somewhat differently from other values.</strong></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="官方举例"><a href="#官方举例" class="headerlink" title="官方举例"></a>官方举例</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; INSERT INTO my_table (phone) VALUES (NULL);</div><div class="line">mysql&gt; INSERT INTO my_table (phone) VALUES ('');</div></pre></td></tr></table></figure>
<p><strong>分别用NULL和空字符串表达不同的含义</strong><br>第一句被看作：电话号码未知<br>第二句被看作：这个人没有电话，所以没有电话号码<br>这样看来，官方是推荐我们使用NULL来表达 <em>未知</em> 的</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT NULL, 1+NULL, CONCAT('Invisible',NULL);</div><div class="line">+------+--------+--------------------------+</div><div class="line">| NULL | 1+NULL | CONCAT('Invisible',NULL) |</div><div class="line">+------+--------+--------------------------+</div><div class="line">| NULL |   NULL | NULL                     |</div><div class="line">+------+--------+--------------------------+</div></pre></td></tr></table></figure>
<p>以上SQL语句验证了NULL的不可操作性</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT * FROM my_table WHERE phone = NULL;</div><div class="line">Empty set (0.00 sec)</div></pre></td></tr></table></figure>
<p>以上SQL语句验证了NULL的不可比性</p>
<h3 id="两个常用的函数"><a href="#两个常用的函数" class="headerlink" title="两个常用的函数"></a>两个常用的函数</h3><p><strong>IFNULL(expr1, expr2)：expr1不为NULL时返回expr1，否则返回expr2</strong><br>我们可以借助IFNULL函数判定该字段是否是一个NULL值<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT IFNULL(1,0);</div><div class="line">+-------------+</div><div class="line">| IFNULL(1,0) |</div><div class="line">+-------------+</div><div class="line">|           1 |</div><div class="line">+-------------+</div><div class="line"></div><div class="line">mysql&gt; SELECT IFNULL(NULL,10);</div><div class="line">+-----------------+</div><div class="line">| IFNULL(NULL,10) |</div><div class="line">+-----------------+</div><div class="line">|              10 |</div><div class="line">+-----------------+</div><div class="line"></div><div class="line">mysql&gt; SELECT IFNULL(1/0,10);</div><div class="line">+----------------+</div><div class="line">| IFNULL(1/0,10) |</div><div class="line">+----------------+</div><div class="line">|        10.0000 |</div><div class="line">+----------------+</div><div class="line">由于对0的整除是无意义的，所以MySQL视其为NULL</div><div class="line"></div><div class="line">mysql&gt; SELECT IFNULL(1/0,'yes');</div><div class="line">+-------------------+</div><div class="line">| IFNULL(1/0,'yes') |</div><div class="line">+-------------------+</div><div class="line">| yes               |</div><div class="line">+-------------------+</div><div class="line">同上</div></pre></td></tr></table></figure></p>
<p><strong>NULLIF(expr1,expr2)：expr1 = expr2相等返回NULL，否则返回expr1</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT NULLIF(1,1);</div><div class="line">+-------------+</div><div class="line">| NULLIF(1,1) |</div><div class="line">+-------------+</div><div class="line">|        NULL |</div><div class="line">+-------------+</div><div class="line"></div><div class="line">mysql&gt; SELECT NULLIF(1,2);</div><div class="line">+-------------+</div><div class="line">| NULLIF(1,2) |</div><div class="line">+-------------+</div><div class="line">|           1 |</div><div class="line">+-------------+</div></pre></td></tr></table></figure></p>
<p>对于经常在SQL中处理逻辑判断的需求是个快捷的方法，可以替代下面复杂的写法<br><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> expr1 = expr2 <span class="keyword">THEN</span> <span class="keyword">NULL</span> <span class="keyword">ELSE</span> expr1 <span class="keyword">END</span>.</div></pre></td></tr></table></figure></p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>不区分大小写</li>
<li>与 \N 同义 【LOAD DATA INFILE/SELECT … INTO OUTFILE的文本中NULL的显示内容】</li>
<li>即不是0也不是空字符串</li>
<li>在MySQL中，0和NULL都表示FALSE</li>
<li><p>不能与任何值进行比较，包括NULL与NULL的比较，且不会得到任何有意义的结果</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT 1 = NULL, 1 &lt;&gt; NULL, 1 &lt; NULL, 1 &gt; NULL;</div><div class="line">+----------+-----------+----------+----------+</div><div class="line">| 1 = NULL | 1 &lt;&gt; NULL | 1 &lt; NULL | 1 &gt; NULL |</div><div class="line">+----------+-----------+----------+----------+</div><div class="line">|     NULL |      NULL |     NULL |     NULL |</div><div class="line">+----------+-----------+----------+----------+</div></pre></td></tr></table></figure>
</li>
<li><p>0和空字符串表示实际值，所以可以插入到NOT NULL的字段中</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT 0 IS NULL, 0 IS NOT NULL, '' IS NULL, '' IS NOT NULL;</div><div class="line">+-----------+---------------+------------+----------------+</div><div class="line">| 0 IS NULL | 0 IS NOT NULL | '' IS NULL | '' IS NOT NULL |</div><div class="line">+-----------+---------------+------------+----------------+</div><div class="line">|         0 |             1 |          0 |              1 |</div><div class="line">+-----------+---------------+------------+----------------+</div></pre></td></tr></table></figure>
<p><em>引申：那么NOT NULL的比较是什么样子</em></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT 1 IS NOT NULL, 0 IS NOT NULL, NULL IS NOT NULL;</div><div class="line">+---------------+---------------+------------------+</div><div class="line">| 1 IS NOT NULL | 0 IS NOT NULL | NULL IS NOT NULL |</div><div class="line">+---------------+---------------+------------------+</div><div class="line">|             1 |             1 |                0 |</div><div class="line">+---------------+---------------+------------------+</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="数据类型相关"><a href="#数据类型相关" class="headerlink" title="数据类型相关"></a>数据类型相关</h3><ul>
<li><p>对于INT和FLOAT类型，且有AUTO_INCREMENT属性的字段，插入的NULL值会被自动增加步长<br>当<a name="sql_auto_is_null">sql_auto_is_null</a>=ON时【默认OFF】，插入一个非明确值，如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 14:35:44&gt;desc t;</div><div class="line">+-------+---------+------+-----+---------+----------------+</div><div class="line">| Field | Type    | Null | Key | Default | Extra          |</div><div class="line">+-------+---------+------+-----+---------+----------------+</div><div class="line">| id    | int(11) | NO   | PRI | NULL    | auto_increment |</div><div class="line">+-------+---------+------+-----+---------+----------------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 12:40:24&gt;insert into t values (null);</div><div class="line">Query OK, 1 row affected (0.01 sec)</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 14:35:31&gt;insert into t values();</div><div class="line">Query OK, 1 row affected (0.01 sec)</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 14:35:35&gt;select * from t where id is null;</div><div class="line">+----+</div><div class="line">| id |</div><div class="line">+----+</div><div class="line">|  6 |</div><div class="line">+----+</div></pre></td></tr></table></figure>
<p>对NOT NULL的字段使用IS NULL，会得到LAST_INSERT_ID()的结果</p>
</li>
<li><p>对于TIMESTAMP类型，插入的NULL会被当前日期时间所替代</p>
<p><em>前提：</em></p>
<p><a name="explicit_defaults_for_timestamp">explicit_defaults_for_timestamp</a>=OFF【默认】时，TIMESTAMP字段默值认为NOT NULL DEFAULT on update CURRENT_TIMESTAMP</p>
<p>explicit_defaults_for_timestamp=ON时，TIMESTAMP类型默认为NULL DEFAULT NULL</p>
</li>
<li><p>对于DATE和DATETIME类型</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 15:11:04&gt;desc t;</div><div class="line">+-------+----------+------+-----+---------+-------+</div><div class="line">| Field | Type     | Null | Key | Default | Extra |</div><div class="line">+-------+----------+------+-----+---------+-------+</div><div class="line">| col   | datetime | NO   |     | NULL    |       |</div><div class="line">| col2  | date     | NO   |     | NULL    |       |</div><div class="line">+-------+----------+------+-----+---------+-------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 15:11:09&gt;select * from t where col is null;</div><div class="line">+---------------------+------------+</div><div class="line">| col                 | col2       |</div><div class="line">+---------------------+------------+</div><div class="line">| 0000-00-00 00:00:00 | 0000-00-00 |</div><div class="line">+---------------------+------------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 15:11:18&gt;select * from t where col2 is null;</div><div class="line">+---------------------+------------+</div><div class="line">| col                 | col2       |</div><div class="line">+---------------------+------------+</div><div class="line">| 0000-00-00 00:00:00 | 0000-00-00 |</div><div class="line">+---------------------+------------+</div></pre></td></tr></table></figure>
<p>使用IS NULL可以得到0000-00-00 00:00:00的值</p>
</li>
</ul>
<h3 id="函数相关"><a href="#函数相关" class="headerlink" title="函数相关"></a>函数相关</h3><ul>
<li><p>连接函数返回NULL</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT CONCAT('My', NULL, 'QL');</div><div class="line">+--------------------------+</div><div class="line">| CONCAT('My', NULL, 'QL') |</div><div class="line">+--------------------------+</div><div class="line">| NULL                     |</div><div class="line">+--------------------------+</div></pre></td></tr></table></figure>
<p><em>引申：那么对于NULL字符串的连接，可以使用CONCAT_WS()来替代，此函数会跳过所有的NULL值</em> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT_WS</span>(<span class="string">','</span>,<span class="string">'First name'</span>,<span class="literal">NULL</span>,<span class="string">'Last Name'</span>);</div><div class="line">+<span class="comment">----------------------------------------------+</span></div><div class="line">| CONCAT_WS(',','First name',NULL,'Last Name') |</div><div class="line">+<span class="comment">----------------------------------------------+</span></div><div class="line">| First name,Last Name                         |</div><div class="line">+<span class="comment">----------------------------------------------+</span></div></pre></td></tr></table></figure>
</li>
<li><p>使用聚合函数COUNT(), MIN(), SUM()时，NULL被忽略</p>
</li>
<li><p>COUNT(*)包含NULL值</p>
<p>也就是COUNT(*)和COUNT(column)结果不同</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 16:51:04&gt;select * from t;</div><div class="line">+------+</div><div class="line">| col  |</div><div class="line">+------+</div><div class="line">|    1 |</div><div class="line">| NULL |</div><div class="line">| NULL |</div><div class="line">+------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 16:51:21&gt;select count(*), count(col) from t;</div><div class="line">+----------+------------+</div><div class="line">| count(*) | count(col) |</div><div class="line">+----------+------------+</div><div class="line">|        3 |          1 |</div><div class="line">+----------+------------+</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="索引相关"><a href="#索引相关" class="headerlink" title="索引相关"></a>索引相关</h3><ul>
<li>只有MyISAM、InnoDB、Memory存储引擎支持在字段上使用NULL和建立索引</li>
<li><p>使用DISTINCT, GROUP BY, ORDER BY时，所有NULL被视作是等同的值</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 17:06:08&gt;select * from t;</div><div class="line">+------+</div><div class="line">| col  |</div><div class="line">+------+</div><div class="line">| NULL |</div><div class="line">| NULL |</div><div class="line">|    1 |</div><div class="line">|    3 |</div><div class="line">+------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 17:07:44&gt;select count(*), count(col) from t1 group by col;</div><div class="line">+----------+-----------+</div><div class="line">| count(*) | count(col) |</div><div class="line">+----------+-----------+</div><div class="line">|        2 |         0 |</div><div class="line">|        1 |         1 |</div><div class="line">|        1 |         1 |</div><div class="line">+----------+-----------+</div></pre></td></tr></table></figure>
</li>
<li><p>使用ORDER BY时，NULL处于首位；加上DESC，NULL处于末位</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 16:33:04&gt;select * from t order by col;</div><div class="line">+------+</div><div class="line">| col  |</div><div class="line">+------+</div><div class="line">| NULL |</div><div class="line">|    1 |</div><div class="line">+------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 16:33:10&gt;select * from t order by col desc;</div><div class="line">+------+</div><div class="line">| col  |</div><div class="line">+------+</div><div class="line">|    1 |</div><div class="line">| NULL |</div><div class="line">+------+</div></pre></td></tr></table></figure>
</li>
<li><p>对于LEFT JOIN右侧的表，条件字段即使有索引，也不会被使用到</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 15:56:46&gt;explain select * from t1 left join t2 on t1.id = t2.id where col='b';</div><div class="line">+----+-------------+-------+------+----------------+---------+---------+------------+------+------------------------------------+</div><div class="line">| id | select_type | table | type | possible_keys  | key     | key_len | ref        | rows | Extra                              |</div><div class="line">+----+-------------+-------+------+----------------+---------+---------+------------+------+------------------------------------+</div><div class="line">|  1 | SIMPLE      | t1    | ref  | idx_id         | idx_id  | 5       | test.t2.id |    1 | Using index                        |</div><div class="line">|  1 | SIMPLE      | t2    | ref  | idx_id,idx_col | idx_col | 32      | const      |    1 | Using index condition; Using where |</div><div class="line">+----+-------------+-------+------+----------------+---------+---------+------------+------+------------------------------------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 15:56:39&gt;explain select * from t1 left join t2 on t1.id = t2.id where col is null;</div><div class="line">+----+-------------+-------+-------+---------------+--------+---------+------+------+----------------------------------------------------------------+</div><div class="line">| id | select_type | table | type  | possible_keys | key    | key_len | ref  | rows | Extra                                                          |</div><div class="line">+----+-------------+-------+-------+---------------+--------+---------+------+------+----------------------------------------------------------------+</div><div class="line">|  1 | SIMPLE      | t1    | index | NULL          | idx_id | 5       | NULL |    3 | Using index                                                    |</div><div class="line">|  1 | SIMPLE      | t2    | ALL   | idx_id        | NULL   | NULL    | NULL |    2 | Using where; Not exists; Using join buffer (Block Nested Loop) |</div><div class="line">+----+-------------+-------+-------+---------------+--------+---------+------+------+----------------------------------------------------------------+</div></pre></td></tr></table></figure>
</li>
<li><p>对于混合条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">key_column=expr OR key_column IS NULL</div></pre></td></tr></table></figure>
<p>在子查询中比较常见，当MySQL进行了优化，EXPLAIN结果中的type是ref_or_null<br><em>ref_or_null的工作原理：先从key中读取数据，然后对NULL值的行进行额外的搜索</em></p>
</li>
<li><p>如果条件语句中包含多个key_column IS NULL，MySQL只优化一个</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t1, t2</div><div class="line">  <span class="keyword">WHERE</span> (t1.a=t2.a <span class="keyword">AND</span> t2.a <span class="keyword">IS</span> <span class="literal">NULL</span>)</div><div class="line">  <span class="keyword">OR</span> (t1.b=t2.b <span class="keyword">AND</span> t2.b <span class="keyword">IS</span> <span class="literal">NULL</span>);</div></pre></td></tr></table></figure>
<p>对于上面语句，MySQL只会对(t1.a=t2.a AND t2.a IS NULL)进行优化，(t1.b=t2.b AND t2.b IS NULL)不会被使用到索引<br><strong><em>所以，不能保证MySQL会想你想象的那样工作</em></strong></p>
</li>
<li><p>如果查询结果集的长度超出了max_allowed_packet配置，字符串函数的返回值是NULL</p>
</li>
</ul>
<h3 id="“坑”相关"><a href="#“坑”相关" class="headerlink" title="“坑”相关"></a>“坑”相关</h3><pre><code>上面哪个没用好都是坑，不过上面的内容官方文档都有说明，下面这个属于开发自己踩到
</code></pre><ul>
<li><p>NOT IN</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 18:17:33&gt;select * from t1;</div><div class="line">+------+------+</div><div class="line">| a    | b    |</div><div class="line">+------+------+</div><div class="line">| 1    | 1    |</div><div class="line">| 2    | NULL |</div><div class="line">| NULL | 3    |</div><div class="line">| 2    | 1    |</div><div class="line">| 2    | NULL |</div><div class="line">| NULL | 3    |</div><div class="line">+------+------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 18:19:03&gt;select * from t2;</div><div class="line">+------+------+</div><div class="line">| a    | b    |</div><div class="line">+------+------+</div><div class="line">| 2    | NULL |</div><div class="line">| NULL | 5    |</div><div class="line">+------+------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 18:17:23&gt;select * from t1 where a not in (1, null);</div><div class="line">Empty set (0.00 sec)</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 18:15:52&gt;select * from t1 where a not in (select a from t2);</div><div class="line">Empty set (0.01 sec)</div></pre></td></tr></table></figure>
<p>单表或联表查询，WHERE条件NOT IN中如果包含NULL值，无法返回正确的结果集</p>
</li>
</ul>
<h2 id="运维"><a href="#运维" class="headerlink" title="运维"></a>运维</h2><p>不同的存储引擎，存储方式不同<br>MyISAM每行头有一个位域用来存储每个字段的NULL编码情况，一个NULL的字段依然占据空间，所以NULL并不会减少/节省空间</p>
<p>InnoDB每行头存储每个字段有一个“域 开始 偏移量”，为每个字段分配1-2个字节。字段为NULL的“域 开始 偏移量”的高位为“ON”。然而这种情况，该字段应该不需要存储任何内容。所以，如果你使用了大量的NULL，你的存储会有明显的降低。</p>
<p>下面针对MyISAM和InnoDB，分别创建了2张表，一种是带主键ID的，一种是不带主键ID的</p>
<h3 id="无索引的容量对比"><a href="#无索引的容量对比" class="headerlink" title="无索引的容量对比"></a>无索引的容量对比</h3><p>带主键ID</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_myisam_null`</span> (</div><div class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</div><div class="line">  <span class="string">`col1`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col2`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col3`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col4`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col5`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col6`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col7`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col8`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col9`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col10`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col11`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col12`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col13`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col14`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col15`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</div><div class="line">) <span class="keyword">ENGINE</span>=MyISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_innodb_null`</span> (</div><div class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</div><div class="line">  <span class="string">`col1`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col2`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col3`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col4`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col5`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col6`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col7`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col8`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col9`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col10`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col11`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col12`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col13`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col14`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col15`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</div><div class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</div></pre></td></tr></table></figure>
<p>不带主键ID</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_myisam_null_noid`</span> (</div><div class="line">  <span class="string">`col1`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col2`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col3`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col4`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col5`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col6`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col7`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col8`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col9`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col10`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col11`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col12`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col13`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col14`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col15`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></div><div class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_innodb_null_noid`</span> (</div><div class="line">  <span class="string">`col1`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col2`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col3`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col4`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col5`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col6`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col7`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col8`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col9`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col10`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col11`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col12`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col13`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col14`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col15`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></div><div class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</div></pre></td></tr></table></figure>
<p>写个脚本造数据，分别INSERT 1千万条记录，除了主键自增ID，所有字段均为NULL</p>
<p>带主键ID</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 14:24:29&gt;select * from t_myisam_null limit 1;</div><div class="line">+----+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+</div><div class="line">| id | col1 | col2 | col3 | col4 | col5 | col6 | col7 | col8 | col9 | col10 | col11 | col12 | col13 | col14 | col15 |</div><div class="line">+----+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+</div><div class="line">|  1 | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  |</div><div class="line">+----+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 14:20:21&gt;select count(*) from t_myisam_null;</div><div class="line">+----------+</div><div class="line">| count(*) |</div><div class="line">+----------+</div><div class="line">| 10000001 |</div><div class="line">+----------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 14:23:28&gt;select count(*) from t_innodb_null;</div><div class="line">+----------+</div><div class="line">| count(*) |</div><div class="line">+----------+</div><div class="line">| 10000001 |</div><div class="line">+----------+</div></pre></td></tr></table></figure>
<p>不带主键ID</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 14:29:05&gt;select * from t_myisam_null_noid limit 1;</div><div class="line">+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+</div><div class="line">| col1 | col2 | col3 | col4 | col5 | col6 | col7 | col8 | col9 | col10 | col11 | col12 | col13 | col14 | col15 |</div><div class="line">+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+</div><div class="line">| NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  |</div><div class="line">+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+</div><div class="line"></div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 14:23:24&gt;select count(*) from t_myisam_null_noid;</div><div class="line">+----------+</div><div class="line">| count(*) |</div><div class="line">+----------+</div><div class="line">| 10000001 |</div><div class="line">+----------+</div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 14:23:41&gt;select count(*) from t_innodb_null_noid;</div><div class="line">+----------+</div><div class="line">| count(*) |</div><div class="line">+----------+</div><div class="line">| 10000001 |</div><div class="line">+----------+</div></pre></td></tr></table></figure>
<p><strong>我们来看下数据文件大小</strong><br>这里的主键ID，我使用了bigint，占8 bytes<br>没有主键的表，系统会创建主键，占6 bytes</p>
<p><img src="/images/5F7E082C-7020-4E85-8379-2B8965A69DCC.png" alt="bigint"></p>
<p>表数据文件大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-rw-rw---- 1 mysql mysql 306M 8月  15 22:19 t_myisam_null.MYD</div><div class="line">-rw-rw---- 1 mysql mysql 308M 8月  15 22:19 t_innodb_null.ibd</div><div class="line"></div><div class="line">-rw-rw---- 1 mysql mysql 191M 8月  15 22:30 t_myisam_null_noid.MYD</div><div class="line">-rw-rw---- 1 mysql mysql 284M 8月  15 22:30 t_innodb_null_noid.ibd</div></pre></td></tr></table></figure>
<p>我们可以看到是否有主键，对于2个存储引擎来说差别还是挺大的，这个这里暂且忽略</p>
<p>从数据文件的大小可以来证明片头的阐述，不管什么存储引擎，VARCHAR类型的NULL值虽然不占空间，但NULL约束的字段的标识值是占空间的</p>
<p><strong>下面我们来看看，有实际数据存储的表是什么样子</strong></p>
<p>这里我们只测试InnoDB带主键ID，且所有字段改为NOT NULL DEFAULT ‘’和上面的区别</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-rw-rw---- 1 mysql mysql 308M 8月  15 22:19 t_innodb_null.ibd</div><div class="line"></div><div class="line">对比下</div><div class="line"></div><div class="line">-rw-rw---- 1 mysql mysql 440M 8月  16 15:20 t_innodb_notnull.ibd</div></pre></td></tr></table></figure>
<p><strong>因为NOT NULL DEFAULT ‘’实际存储空字符，所以比NULL DEFAULT NULL的数据文件大一些，而NULL DEFAULT NULL的数据，实际上是行头数据</strong></p>
<p><img src="/images/753C4964-3E6F-489B-893D-0E4137917DB6.png" alt="varcahr"></p>
<p>varchar(<em>M</em>)是否与空间有关系<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-rw-rw---- 1 mysql mysql 440M 8月  16 16:12 t_innodb_notnull_varchar10.ibd</div></pre></td></tr></table></figure></p>
<p><strong>对于varchar(10)和varchar(100)，同样存储aaa字符串，文件大小是一样的。<em>varchar(M)</em>中的<em>M</em>除了控制字符串长度，也会影响该字段申请内存的大小，<em>M</em>多大就申请多大内存</strong></p>
<p>我们将2张表改为DEFAULT ‘aaa’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-rw-rw---- 1 mysql mysql 932M 8月  16 17:26 t_innodb_null_aaa.ibd</div><div class="line">-rw-rw---- 1 mysql mysql 912M 8月  16 17:26 t_innodb_notnull_aaa.ibd</div></pre></td></tr></table></figure></p>
<p><strong>NULL DEFAULT ‘aaa’比NOT NULL DEFAULT ‘aaa’的数据文件大一些</strong></p>
<table>
<thead>
<tr>
<th>PRIMARY KEY</th>
<th>ENGINE</th>
<th>CONSTRAINT</th>
<th>DATA LENGTH (byte)</th>
<th>FILE SIZE (byte)</th>
</tr>
</thead>
<tbody>
<tr>
<td>NONE</td>
<td>MyISAM</td>
<td>NULL DEFAULT NULL</td>
<td>320000032</td>
<td>320000032</td>
</tr>
<tr>
<td>NONE</td>
<td>InnoDB</td>
<td>NULL DEFAULT NULL</td>
<td>279805952</td>
<td>322961408</td>
</tr>
<tr>
<td>ID</td>
<td>MyISAM</td>
<td>NULL DEFAULT NULL</td>
<td>200000020</td>
<td>200000020</td>
</tr>
<tr>
<td>ID</td>
<td>InnoDB</td>
<td>NULL DEFAULT NULL</td>
<td>286081024</td>
<td>297795584</td>
</tr>
<tr>
<td>ID</td>
<td>InnoDB</td>
<td>NULL DEFAULT ‘aaa’</td>
<td>878706688</td>
<td>977272832</td>
</tr>
<tr>
<td>ID</td>
<td>InnoDB</td>
<td>NOT NULL DEFAULT ‘aaa’</td>
<td>909115392</td>
<td>956301312</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="有索引的容量对比"><a href="#有索引的容量对比" class="headerlink" title="有索引的容量对比"></a>有索引的容量对比</h3><p>表结构同上，InnoDB 存储引擎，为col10增加非聚集索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_innodb_null_key`</span> (</div><div class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</div><div class="line">  <span class="string">`col1`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col2`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col3`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col4`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col5`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col6`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col7`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col8`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col9`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col10`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col11`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col12`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col13`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col14`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`col15`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</div><div class="line">  <span class="keyword">KEY</span> idx_col10(col10)</div><div class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_innodb_notnull_key`</span> (</div><div class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</div><div class="line">  <span class="string">`col1`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col2`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col3`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col4`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col5`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col6`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col7`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col8`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col9`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col10`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col11`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col12`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col13`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col14`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`col15`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</div><div class="line">  <span class="keyword">KEY</span> idx_col10(col10)</div><div class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-rw-rw---- 1 mysql mysql 448M 8月  17 15:55 t_innodb_null_key.ibd</div><div class="line">-rw-rw---- 1 mysql mysql 584M 8月  17 15:55 t_innodb_notnull_key.ibd</div></pre></td></tr></table></figure>
<p>同上，NOT NULL略大一些</p>
<p>增加实际默认值<br>varchar(100) NULL DEFAULT ‘a’<br>varchar(100) NOT NULL DEFAULT ‘a’</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-rw-rw---- 1 mysql mysql 780M 8月  17 16:15 t_innodb_null_key_a.ibd</div><div class="line">-rw-rw---- 1 mysql mysql 752M 8月  17 16:15 t_innodb_notnull_key_a.ibd</div></pre></td></tr></table></figure>
<p><strong>由于MySQL为会为NULL的字段记录标识状态，当写入实际数据的时候，就体现出含NULL类型字段的表文件更大一些，那么占用磁盘空间也就更多些</strong></p>
<p><strong>索引利用情况</strong></p>
<p>下面查询WHERE IS NOT NULL，即表中不存在的数据</p>
<p>varchar(100) NULL DEFAULT NULL<br>varchar(100) NOT NULL DEFAULT ‘’</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 16:51:09&gt;explain  select * from t_innodb_null_key where col10 is not null;</div><div class="line">+----+-------------+-------------------+-------+---------------+-----------+---------+------+------+-----------------------+</div><div class="line">| id | select_type | table             | type  | possible_keys | key       | key_len | ref  | rows | Extra                 |</div><div class="line">+----+-------------+-------------------+-------+---------------+-----------+---------+------+------+-----------------------+</div><div class="line">|  1 | SIMPLE      | t_innodb_null_key | range | idx_col10     | idx_col10 | 303     | NULL |    1 | Using index condition |</div><div class="line">+----+-------------+-------------------+-------+---------------+-----------+---------+------+------+-----------------------+</div><div class="line"></div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 16:57:32&gt;explain select * from t_innodb_notnull_key where col10 &lt;&gt; '';</div><div class="line">+----+-------------+----------------------+-------+---------------+-----------+---------+------+------+-----------------------+</div><div class="line">| id | select_type | table                | type  | possible_keys | key       | key_len | ref  | rows | Extra                 |</div><div class="line">+----+-------------+----------------------+-------+---------------+-----------+---------+------+------+-----------------------+</div><div class="line">|  1 | SIMPLE      | t_innodb_notnull_key | range | idx_col10     | idx_col10 | 302     | NULL |    2 | Using index condition |</div><div class="line">+----+-------------+----------------------+-------+---------------+-----------+---------+------+------+-----------------------+</div></pre></td></tr></table></figure>
<p>varchar(100) NULL DEFAULT ‘a’<br>varchar(100) NOT NULL DEFAULT ‘a’</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">katyusha@127.0.0.1:3306:test 17:07:40&gt;explain select * from t_innodb_null_key_a where col10 = 'a';</div><div class="line">+----+-------------+---------------------+------+---------------+-----------+---------+-------+---------+-----------------------+</div><div class="line">| id | select_type | table               | type | possible_keys | key       | key_len | ref   | rows    | Extra                 |</div><div class="line">+----+-------------+---------------------+------+---------------+-----------+---------+-------+---------+-----------------------+</div><div class="line">|  1 | SIMPLE      | t_innodb_null_key_a | ref  | idx_col10     | idx_col10 | 303     | const | 4478865 | Using index condition |</div><div class="line">+----+-------------+---------------------+------+---------------+-----------+---------+-------+---------+-----------------------+</div><div class="line"></div><div class="line"></div><div class="line">katyusha@127.0.0.1:3306:test 17:07:50&gt;explain select * from t_innodb_notnull_key_a where col10 = 'a';</div><div class="line">+----+-------------+------------------------+------+---------------+-----------+---------+-------+---------+-----------------------+</div><div class="line">| id | select_type | table                  | type | possible_keys | key       | key_len | ref   | rows    | Extra                 |</div><div class="line">+----+-------------+------------------------+------+---------------+-----------+---------+-------+---------+-----------------------+</div><div class="line">|  1 | SIMPLE      | t_innodb_notnull_key_a | ref  | idx_col10     | idx_col10 | 302     | const | 4513315 | Using index condition |</div><div class="line">+----+-------------+------------------------+------+---------------+-----------+---------+-------+---------+-----------------------+</div></pre></td></tr></table></figure>
<p><strong>NULL DEFAUL NULL多出一个标识位空间</strong><br><strong>文件头有3个字节，NULL标识符占1字节，变长类型占1字节，记录字段长度占1字节<br>对于UTF8编码，对于VARCHAR(<em>M</em>)类型字段，NULL的key_length=m*3+3，NOT NULL的key_length=m*3+3</strong></p>
<table>
<thead>
<tr>
<th>ENGINE</th>
<th>CONSTRAINT</th>
<th>KEY LENGTH (byte)</th>
<th>INDEX LENGTH (byte)</th>
<th>DATA LENGTH (byte)</th>
<th>FILE SIZE (byte)</th>
</tr>
</thead>
<tbody>
<tr>
<td>InnoDB</td>
<td>NULL DEFAULT NULL</td>
<td>303</td>
<td>141230080</td>
<td>295567360</td>
<td>469762048</td>
</tr>
<tr>
<td>InnoDB</td>
<td>NOT NULL DEFAULT ‘’</td>
<td>302</td>
<td>141230080</td>
<td>431980544</td>
<td>612368384</td>
</tr>
<tr>
<td>InnoDB</td>
<td>NULL DEFAULT ‘a’</td>
<td>303</td>
<td>153845760</td>
<td>583008256</td>
<td>817889280</td>
</tr>
<tr>
<td>InnoDB</td>
<td>NOT NULL DEFAULT ‘a’</td>
<td>302</td>
<td>146489344</td>
<td>568328192</td>
<td>788529152</td>
</tr>
</tbody>
</table>
<p><strong>结论，如果为一个拥有NULL约束的字段添加索引，会增加数据文件的尺寸；以此类推，这样的索引字段越多就会占用更多的磁盘空间</strong></p>
<h3 id="受系统配置影响的"><a href="#受系统配置影响的" class="headerlink" title="受系统配置影响的"></a>受系统配置影响的</h3><p>在上面的注意事项中，我们发现有几个问题是依赖于系统环境变量的，这部分内容与DBA相关，所以再次拿出来列举一下<br><a href="#sql_auto_is_null">sql_auto_is_null</a><br>我们的设置：sql_auto_is_null=OFF【默认】</p>
<p><a href="#explicit_defaults_for_timestamp">explicit_defaults_for_timestamp</a><br>我们的设置：explicit_defaults_for_timestamp=ON</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我们从开发和运维两个层面分别展示了下NULL，能看到这里的都是英雄</p>
<p>NULL有它便利的地方，但是它给我们带来的麻烦也不少。因此，为了让开发可以更专注在业务逻辑上，让DBA可以优化数据库的性能上</p>
<p>请DBA将NULL to NOT NULL补充到SQL开发规范中<br>请开发在创建表结构的时候尽可能将字段设置为NOT NULL</p>
<p>PS：<a href="/2016/05/23/osc/#null2notnull">pt-osc也提供了选项可以优化NULL to NOT NULL</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://mckobe23.github.io/2016/08/10/null2notnull/" data-id="cit18636u000boxfyk207oo30" class="article-share-link">Share</a><div class="tags"><a href="/tags/mysql/">mysql</a><a href="/tags/not-null/">not null</a></div><div class="post-nav"><a href="/2016/08/18/key-length/" class="pre">EXPLAIN key_length</a><a href="/2016/08/10/redis-info-output-format/" class="next">Redis INFO输出文本后的编码问题</a></div><div id="disqus_thread"><script>var disqus_shortname = 'mckobe23';
var disqus_identifier = '2016/08/10/null2notnull/';
var disqus_title = '关于NULL to NOT NULL';
var disqus_url = 'http://mckobe23.github.io/2016/08/10/null2notnull/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//mckobe23.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://mckobe23.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/not-null/" style="font-size: 15px;">not null</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/innodb/" style="font-size: 15px;">innodb</a> <a href="/tags/tokudb/" style="font-size: 15px;">tokudb</a> <a href="/tags/replace-into/" style="font-size: 15px;">replace into</a> <a href="/tags/auto-increment/" style="font-size: 15px;">auto increment</a> <a href="/tags/explain/" style="font-size: 15px;">explain</a> <a href="/tags/key-len/" style="font-size: 15px;">key_len</a> <a href="/tags/mha/" style="font-size: 15px;">mha</a> <a href="/tags/myisam/" style="font-size: 15px;">myisam</a> <a href="/tags/osc/" style="font-size: 15px;">osc</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/mongodb/" style="font-size: 15px;">mongodb</a> <a href="/tags/semi-sync/" style="font-size: 15px;">semi-sync</a> <a href="/tags/sqlserver/" style="font-size: 15px;">sqlserver</a> <a href="/tags/oracle/" style="font-size: 15px;">oracle</a> <a href="/tags/update/" style="font-size: 15px;">update</a> <a href="/tags/utf8mb4/" style="font-size: 15px;">utf8mb4</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/08/18/key-length/">EXPLAIN key_length</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/10/null2notnull/">关于NULL to NOT NULL</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/10/redis-info-output-format/">Redis INFO输出文本后的编码问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/28/autoincrment-conflict/">自增主键同步差异后的故障切换，自增主键冲突</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/22/replace-autoincrement/">Replace into 带来的主从自增主键差异</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/07/mongodb-deploy/">MongoDB部署</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/06/redis-deploy/">Redis部署</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/30/update-snytax/">UPDATE SYNTAX</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/23/osc/">pt-osc工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/10/engine-innodb/">MySQL存储引擎InnoDB</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//mckobe23.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://hbprotoss.github.io" title="hbprotoss的博客" target="_blank">hbprotoss的博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">喀秋莎的技术博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>